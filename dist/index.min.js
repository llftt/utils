!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Test={})}(this,function(e){"use strict";var i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e},a=function(){function t(){var n,r;i(this,t);var e=new Promise(function(e,t){n=e,r=t});return e.resolve=n,e.reject=r,e}return n(t,[{key:"resolve",value:function(){}},{key:"reject",value:function(){}}]),t}();var t=function(){function e(){i(this,e),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return n(e,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}},{key:"addBytes",value:function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0===e&&(e=1),this._intervalBytes/e/1024}},{key:"lastSecondKBps",get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:500<=this._now()-this._lastCheckpoint?this.currentKBps:0}},{key:"averageKBps",get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}}]),e}(),l=function(){function l(){i(this,l)}return n(l,null,[{key:"findChild",value:function(e,t){var n=l.findChildren(e,t);return 1!==n.length?null:n[0]}},{key:"findChildNS",value:function(e,t,n){var r=l.findChildrenNS(e,t,n);return 1!==r.length?null:r[0]}},{key:"findChildren",value:function(e,t){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.tagName===t})}},{key:"findChildrenNS",value:function(e,t,n){return Array.from(e.childNodes).filter(function(e){return e instanceof Element&&e.localName===n&&e.namespaceURI===t})}},{key:"getAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}},{key:"getContents",value:function(e){return Array.from(e.childNodes).every(function(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.CDATA_SECTION_NODE})?e.textContent.trim():null}},{key:"parseAttr",value:function(e,t,n,r){var l=3<arguments.length&&void 0!==r?r:null,i=null,a=e.getAttribute(t);return null!=a&&(i=n(a)),null==i?l:i}},{key:"parseInt",value:function(e){var t=Number(e);return t%1==0?t:null}},{key:"parsePositiveInt",value:function(e){var t=Number(e);return t%1==0&&0<t?t:null}},{key:"parseNonNegativeInt",value:function(e){var t=Number(e);return t%1==0&&0<=t?t:null}},{key:"parseFloat",value:function(e){var t=Number(e);return isNaN(t)?null:t}},{key:"evalDivision",value:function(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}},{key:"parseXmlString",value:function(e,t){var n=new DOMParser,r=null,l=null;try{l=n.parseFromString(e,"text/xml")}catch(e){}return l&&l.documentElement.tagName===t&&(r=l.documentElement),r&&0<r.getElementsByTagName("parsererror").length?null:r}},{key:"parseXml",value:function(e,t){try{return l.parseXmlString(e,t)}catch(e){return null}}}]),l}(),u=function(){function e(){i(this,e)}return n(e,null,[{key:"parseDate",value:function(e){if(!e)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z");var t=Date.parse(e);return isNaN(t)?null:Math.floor(t/1e3)}},{key:"parseDuration",value:function(e){if(!e)return null;var t=new RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e);if(!t)return null;var n=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null);return isFinite(n)?n:null}},{key:"parseRange",value:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var n=Number(t[1]);if(!isFinite(n))return null;var r=Number(t[2]);return isFinite(r)?{start:n,end:r}:null}}]),e}(),o=function(){function g(){i(this,g)}return n(g,null,[{key:"parse",value:function(e){var t=g.parseXmlString(e);return null!=t?g.parseDOMChildren(t):null}},{key:"parseXmlString",value:function(e){if(void 0===e)return null;var t,n=new window.DOMParser;try{0<(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(t=null)}catch(e){t=null}return t}},{key:"parseDOMChildren",value:function(e,t){if(e.nodeType===Node.DOCUMENT_NODE){for(var n={},r=e.childNodes,l=0;l<r.length;l++){var i=r[l];i.nodeType===Node.ELEMENT_NODE&&(n=g.parseDOMChildren(i))}return n}if(e.nodeType===Node.ELEMENT_NODE){for(var a={__cnt:0},u=[],o=e.childNodes,s=0;s<o.length;s++){var c,f,h,d,y,v=o[s],_=g.getNodeLocalName(v);v.nodeType!==Node.COMMENT_NODE&&(c=t+"."+_,a.__cnt++,null==a[_]?(f=g.parseDOMChildren(v,c),"#text"===_&&!/[^\s]/.test(f)||((h={})[_]=f,u.push(h)),a[_]=f,g.toArrayAccessForm(a,_)):(null!=a[_]&&(a[_]instanceof Array||(a[_]=[a[_]],g.toArrayAccessForm(a,_,c))),d=g.parseDOMChildren(v,c),"#text"===_&&!/[^\s]/.test(d)||((y={})[_]=d,u.push(y)),a[_][a[_].length]=d))}for(var p=0;p<e.attributes.length;p++){var m=e.attributes[p];a.__cnt++;var N=m.value;a[m.name]=N}var k=e.prefix;return null!=k&&""!==k&&(a.__cnt++,a.__prefix=k),null!=a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),delete a["#text"],delete a["#text_asArray"]),null!=a["#cdata-section"]&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],delete a["#cdata-section_asArray"]),1===a.__cnt&&null!=a.__text?a=a.__text:1===a.__cnt&&null!=a.__cdata&&(a=a.__cdata),delete a.__cnt,a}if(e.nodeType===Node.TEXT_NODE||e.nodeType===Node.CDATA_SECTION_NODE)return e.nodeValue}},{key:"getNodeLocalName",value:function(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!==t||(t=e.nodeName),t}},{key:"toArrayAccessForm",value:function(e,t){e[t]instanceof Array||(e[t]=[e[t]])}}]),g}();e.ProxyPromise=a,e.Speedsampler=t,e.Utils=u,e.Xml2Json=o,e.XmlUtils=l,e.isSupportRawCryptoCTR=function(){var n=new a,t=window.crypto||window.msCrypto;if(!t)return n.resolve(!1),n;var r=new Uint8Array(16),l=new Uint8Array([1]),i=null;try{t.subtle.generateKey({name:"AES-CTR",length:256},!1,["encrypt","decrypt"]).then(function(e){return i=e,t.subtle.encrypt({name:"AES-CTR",counter:r,length:128},e,l)}).then(function(e){return t.subtle.decrypt({name:"AES-CTR",counter:r,length:128},i,e)}).then(function(e){var t=new Uint8Array(e);n.resolve(t[0]===l[0])}).catch(function(){n.resolve(!1)})}catch(e){n.resolve(!1)}return n},Object.defineProperty(e,"__esModule",{value:!0})});
